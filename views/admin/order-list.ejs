<%- include("../../views/partials/admin/header") %>

<div class="content-header row">
  <div class="d-flex justify-content-between align-items-center">
    <h2 class="content-title card-title">Orders</h2>
  </div>
</div>

<header class="card-header text-center mb-20">
  <form action="/admin/orders" method="get" class="d-inline">
    <div class="input-group input-group-sm border border-1 border-grey rounded-pill" style="width: 500px; margin-left: 230px;">
      <input
        type="text"
        class="form-control border-0"
        placeholder="Search orders by Order ID..."
        name="search"
        value="<%= search || '' %>"
        style="border-top-left-radius: 9999px; border-bottom-left-radius: 9999px; border-top-right-radius: 0; border-bottom-right-radius: 0;"
      />
      <button
        class="btn btn-primary"
        type="submit"
        style="border-radius: 0; border-right: none;"
      >
        Search
      </button>
      <a
        href="/admin/orders"
        class="btn btn-secondary"
        style="border-top-right-radius: 9999px; border-bottom-right-radius: 9999px; border-left: none;"
      >
        Clear
      </a>
    </div>
  </form>
</header>

<div class="right mt-5">
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col"><b>Order ID</b></th>
        <th scope="col"><b>Order Date</b></th>
        <th scope="col"><b>User Name</b></th>
        <th scope="col"><b>User Email</b></th>
        <th scope="col"><b>Action</b></th>
      </tr>
    </thead>
    <tbody>
      <% if (orders.length === 0) { %>
        <tr>
          <td colspan="5" class="text-center">No orders found.</td>
        </tr>
      <% } %>
      <% orders.forEach(order => { %>
        <tr>
          <td><%= order._id %></td>
          <td><%= order.createdOn.toLocaleString() %></td>
          <td><%= order.user?.name || 'N/A' %></td>
          <td><%= order.user?.email || 'N/A' %></td>
          <td>
            <a href="/admin/orders/<%= order._id %>" class="btn btn-primary btn-sm">View</a>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<div class="container mt-3">
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center mb-20" style="margin-right: 200px;">
      <% for (let i = 1; i <= totalPages; i++) { %>
        <li class="page-item <%= currentPage == i ? 'active' : '' %>">
          <a class="page-link" href="?page=<%= i %><%= search ? '&search=' + search : '' %>"><%= i %></a>
        </li>
      <% } %>
    </ul>
  </nav>
</div>

<%- include("../../views/partials/admin/footer") %>
